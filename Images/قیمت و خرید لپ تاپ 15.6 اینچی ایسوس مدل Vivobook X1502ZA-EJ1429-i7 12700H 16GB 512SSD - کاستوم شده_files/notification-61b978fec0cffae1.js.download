(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1909],{83514:function(t,i,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/notification",function(){return n(26919)}])},26919:function(t,i,n){"use strict";n.r(i),n.d(i,{default:function(){return is}});var e=n(2784),o=n(66383),a=n(52322),s=n(70423),c=n(5632),r=n(72610),l=n(27876),d=n(41218),u=n(88589),f=n(64665),m=n(45873),p=n(11559),x=n(72873),g=n(64177),N=n(53828),T=n(87049),v=n(8108),h=n(43287);function b(t){var i=t.widgetName,n=t.itemClickedName;(0,v.N)({name:"widget_click",body:{version:2,page_type:(0,h.C)(),widget_name:i,clicked_item_name:n}})}function C(t){b({widgetName:"first_open_notification",itemClickedName:t.notificationId})}function j(t){b({widgetName:"reopen_notification",itemClickedName:t.notificationId})}function E(t){b({widgetName:"read_all",itemClickedName:t.unreadNotificationCount})}function I(t){var i,n,e;n=(i={itemClickedName:t.tabTitle,widgetName:"notification_center_tabs"}).widgetName,e=i.itemClickedName,(0,v.N)({name:"widget_click",body:{version:2,page_type:(0,h.C)(),widget_name:n,clicked_item_name:e}})}var A=n(80786),_=n(6013),y=n(99125),S=n(42306),O=n(90287),k=n(41435),R=n(17156),w=n(82650),P=n(94042),M=n(52216),L=n(70582),D={SEEN:"SEEN",NOT_SEEN:"NOT_SEEN"},Y={seen:D.SEEN,not_seen:D.NOT_SEEN},U=n(79968),G=n(46932),F=n(1324),B=(0,F.q)({url:"profile/notifications/",transformer:function(t){var i=t.data||{},n=i.notifications,e=i.alert,o=i.pager;return{notifications:(null==n?void 0:n.map(function(t){var i,n,e,o,a,s,c,r,l,d,u,f,m,p,x,g,N,T,v,h,b,C,j,E,I,A;return m=(f=t||{}).id,p=f.title,x=f.message,g=f.images,N=f.date,T=f.url,v=f.main_image,h=f.status,b=f.type,C=f.icon,j=f.action,E=f.expiration_text,I=f.is_expired,A=f.magnet_meta_data,{notificationId:m,notificationType:b,notificationTitle:(0,M.U)(p),notificationMessage:(0,M.U)(x),notificationDate:(0,M.U)(N),notificationMainImage:(0,L.W)({data:v}),notificationImages:(null==g?void 0:null===(u=g.map)||void 0===u?void 0:u.call(g,function(t){return(0,L.W)({data:t})}))||[],notificationStatus:Y[h],notificationAction:!(0,k.x)(j)&&{notificationActionTitle:(i=j||{}).action_title,notificationActionValue:i.action_value,notificationActionType:i.action_type},notificationUrl:(0,U.f)({data:T}),notificationIcon:(e=(n=C||{}).image,o=n.background_color,{notificationIconUrl:(0,L.W)({data:e}),notificationIconBackgroundColor:o}),notificationIsExpired:I,notificationExpirationText:(0,M.U)(E),notificationMagnetData:(s=(a=A||{}).to_follow,c=a.name,r=a.username,l=a.bio,d=a.mentioned_comment_id,{notificationMagnetToFollow:s,notificationMagnetType:a.type,notificationMagnetName:c,notificationMagnetBio:(0,M.U)(l),notificationMagnetUsername:r,notificationMagnetMentionedCommentId:d})}}))||[],pinNotification:e,pager:(0,G.d)({data:o})}}}),q=n(45227),Z=n(8398),z=(0,F.q)({url:"/notification/seen/",type:q.XN.POST,inputTransformer:Z.d}),K=n(31909),H=n(72677);function W(t){var i=t.className;return(0,a.jsxs)("div",{"data-testid":"profile-notifications-empty-state",className:(0,H.d)("bg-neutral-000 flex flex-col items-center justify-center h-full mx-2 py-18 lg:pt-20 lg:pb-30 user-select-none",i),children:[(0,a.jsx)(K.E,{width:256,height:192,alt:"Empty Notification",src:"/statics/img/svg/profile/empty-notification.svg"}),(0,a.jsx)("div",{className:"mt-3 text-h5 text-neutral-800",children:"هنوز که خبری نیست..."}),(0,a.jsx)("div",{className:"text-body-1 text-neutral-600",children:"پیام‌ها و خبرها را اینجا نمایش خواهیم داد"})]})}function X(t){var i=t.notificationAction||{},n=i.notificationActionTitle,e=i.notificationActionValue;return(0,a.jsxs)("div",{"data-testid":"notification-action-badge",className:"flex items-center gap-1 bg-neutral-100 h-6 rounded-medium-plus px-2",children:[(0,a.jsxs)("p",{className:"text-body-2",children:[n,":"]}),(0,a.jsx)("p",{className:"text-body2-strong tracking-[4px]",children:e})]})}var J=n(98723);function V(t){var i=t.className,n=t.text,e=t.onClick,o=t.to,s=t.pending,c=t.color,l=t.isDisabled;return(0,a.jsx)(J.r,{"data-testid":"notification-action-button",className:(0,H.d)("h-8 flex justify-center items-center text-body2-strong whitespace-nowrap rounded-large px-3 py-1 grow-0 border-[1px] border-solid",i,"high-emphasis"===(void 0===c?"high-emphasis":c)?"text-neutral-650 border-neutral-650":"text-dark-neutral-500 border-dark-neutral-500"),to:o,disabled:l,onClick:!l&&e,children:s?(0,a.jsx)(r.g,{"data-testid":"loading",size:20}):n})}var Q=n(36696),$=n(75490),tt=n(47842),ti=n(27314),tn=n(58449),te=(0,F.q)({url:function(t){var i=t.notificationId;return"/notification/".concat(i,"/click/")},type:q.XN.POST,inputTransformer:function(t){return{notificationId:t.notificationId}}}),to=(0,F.q)({type:q.XN.POST,url:function(t){var i=t.notificationId;return"notification/".concat(i,"/seen/")}}),ta=n(18814),ts=n.n(ta),tc={mobile:36,desktop:44};function tr(t){var i=t.notification,n=t.leftSlot,e=t.bottomSlot,o=t.isLeftSlotCenter,s=i||{},c=s.notificationId,r=s.notificationUrl,l=s.notificationIcon,d=s.notificationTitle,u=s.notificationDate,f=s.notificationMessage,m=s.notificationStatus,x=s.notificationExpirationText,v=s.notificationIsExpired,h=(0,ti.e)().redirect,b=(0,N.I)(),E=(0,T.v)(_.p.notificationCount),I=(0,g.C)().isDesktop,A=(0,p.E)({apiMethod:to}).request,S=(0,p.E)({apiMethod:te}).request;if((0,k.x)(i))return null;var O=(0,tn.k)(f);return(0,a.jsx)("div",{"data-testid":"notification-base-card",className:(0,H.d)("relative py-3 px-4 cursor-pointer",(0,tt.Z)({},ts().NotificationBaseCard__background,m===D.NOT_SEEN)),onClick:v?function(){(0,$.p)({message:x||"این پیام منقضی شده است."})}:function(){h({url:r}),S({notificationId:c}),m===D.NOT_SEEN?(C({notificationId:c}),A({notificationId:c}),b((0,y.d2)(E-1))):j({notificationId:c})},children:(0,a.jsxs)("div",{className:(0,H.d)("z-2 flex gap-2 justify-between text-neutral-900",{"items-center":O||o,"opacity-[50%]":v}),children:[(0,a.jsxs)("div",{className:(0,H.d)("flex gap-3",{"w-full":!n}),children:[(0,a.jsx)(K.E,{className:"shrink-0",imageClassName:"rounded-circle",height:I?tc.desktop:tc.mobile,width:I?tc.desktop:tc.mobile,src:"/statics/img/svg/profile/notification-default-placeholder.svg",image:null==l?void 0:l.notificationIconUrl}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("p",{className:"text-body2-strong",children:d}),!O&&(0,a.jsx)("p",{className:"text-body-2 text-neutral-600",children:f}),e,(0,a.jsx)("p",{className:"text-caption-compact text-neutral-500 mt-1",children:(0,M.U)(u)})]})]}),n?(0,a.jsx)("div",{children:n}):null]})})}function tl(t){var i=t.notification,n=i||{},e=n.notificationAction,s=n.notificationIsExpired,c=(0,o.Z)((0,Q.m)(),2),r=(c[0],c[1]),l=(e||{}).notificationActionValue;return(0,a.jsx)(tr,{notification:i,bottomSlot:(0,a.jsxs)("div",{className:"flex justify-between items-center py-3",children:[(0,a.jsx)(X,{notificationAction:e}),(0,a.jsx)(V,{className:"cursor-copy",text:"کپی‌کردن کد",onClick:function(t){t.stopPropagation(),r(l),(0,$.p)({message:"کد کپی شد"})},isDisabled:s})]})})}var td={INFORM:"inform",INFORM_ACTION:"inform_action",INFORM_ACTION_IMAGES:"inform_action_images",INFORM_ACTION_COPY:"inform_action_copy",MAGNET:"magnet"},tu={mobile:32,desktop:40},tf={mobile:3,desktop:6};function tm(t){var i=t.notificationImages,n=void 0===i?[]:i,o=(0,g.C)().isDesktop,s=o?tf.desktop:tf.mobile,c=n.length-s,r=(0,e.useMemo)(function(){return n.slice(0,s)},[n,s]),l=o?tu.desktop:tu.mobile;return(0,k.x)(n)?null:(0,a.jsxs)("div",{className:"flex gap-1","data-testid":"profile-notification-images",children:[r.map(function(t){return(0,a.jsx)(K.E,{imageClassName:"rounded border-complete",image:t,height:l,width:l})}),c>0&&(0,a.jsxs)("div",{style:{height:l,width:l},className:"flex items-center justify-center text-body-2 bg-app-background-mid-dark rounded border-complete",children:[(0,M.U)(c),"+"]})]})}var tp={LINK:"link",COPY:"copy","NONE-COPY":"none-copy"};function tx(t){var i=t.notification,n=i||{},e=n.notificationUrl,o=n.notificationAction,s=n.notificationImages,c=n.notificationIsExpired,r=!(0,k.x)(o),l=(null==o?void 0:o.notificationActionType)===tp.LINK?(0,a.jsx)(V,{text:o.notificationActionTitle,to:e,isDisabled:c}):(0,a.jsx)(X,{notificationAction:o});return(0,a.jsx)(tr,{notification:i,bottomSlot:(0,a.jsxs)("div",{className:(0,H.d)("py-3 flex items-center",(0,k.x)(s)?"justify-end":"justify-between"),children:[(0,a.jsx)(tm,{notificationImages:s||[]}),r?l:null]})})}function tg(t){var i=t.notification,n=i||{},e=n.notificationAction,o=n.notificationUrl,s=n.notificationIsExpired,c=e||{},r=c.notificationActionTitle,l=c.notificationActionType;return(0,a.jsx)(tr,{notification:i,leftSlot:l===tp.LINK?(0,a.jsx)(V,{to:o,text:r,isDisabled:s}):(0,a.jsx)(X,{notificationAction:e})})}var tN={mobile:44,desktop:56};function tT(t){var i=t.notification,n=(i||{}).notificationMainImage,e=(0,g.C)().isDesktop;return(0,a.jsx)(tr,{isLeftSlotCenter:!0,leftSlot:(0,k.x)(n)?null:(0,a.jsx)(K.E,{"data-testid":"notification-inform-card-image",imageClassName:"rounded",image:n,height:e?tN.desktop:tN.mobile,width:e?tN.desktop:tN.mobile}),notification:i})}var tv={MAGNET_LIKE_CONTENT:"magnet_like_content",MAGNET_FOLLOW:"magnet_follow",MAGNET_COMMENT_CREATED:"magnet_comment_created",MAGNET_MENTIONED:"magnet_mentioned"},th=n(74136),tb=n(18577),tC=n(71390),tj=n(19436),tE=n.n(tj),tI={mobile:36,desktop:44};function tA(t){var i=t.notification,n=t.leftSlot,e=(0,ti.e)().redirect,o=(0,g.C)().isDesktop,s=(0,N.I)(),c=(0,T.v)(_.p.notificationCount),r=i.notificationId,l=i.notificationUrl,d=i.notificationIcon,u=i.notificationTitle,f=i.notificationDate,m=i.notificationMessage,x=i.notificationStatus,v=i.notificationIsExpired,h=i.notificationExpirationText,b=(0,p.E)({apiMethod:to}).request,E=(0,p.E)({apiMethod:te}).request,I=(0,tn.k)(m);return(0,tb.xb)(i)?null:(0,a.jsx)("div",{className:(0,tb.dh)("relative py-3 px-4 cursor-pointer",(0,tt.Z)({},tE().NotificationBaseCard__background,x===D.NOT_SEEN)),children:(0,a.jsxs)("div",{className:(0,tb.dh)("z-2 flex gap-2 justify-between text-neutral-900 items-center",{"opacity-[50%]":v}),onClick:v?function(){(0,$.p)({message:h||"این پیام منقضی شده است."})}:function(){e({url:l}),E({notificationId:r}),x===D.NOT_SEEN?(C({notificationId:r}),b({notificationId:r}),s((0,y.d2)(c-1))):j({notificationId:r})},children:[(0,a.jsxs)("div",{className:(0,tb.dh)("flex gap-3",{"w-full":!n}),children:[(0,a.jsx)(K.E,{className:"shrink-0",imageClassName:"rounded-circle",height:o?tI.desktop:tI.mobile,width:o?tI.desktop:tI.mobile,src:tC.C,image:null==d?void 0:d.notificationIconUrl}),(0,a.jsxs)("div",{className:"w-full",children:[(0,a.jsx)("p",{className:"text-body2-strong",children:u}),!I&&(0,a.jsx)("p",{className:"text-body-2 text-neutral-600",children:m}),(0,a.jsx)("p",{className:"text-caption-compact text-neutral-500 mt-1",children:(0,tb.Uu)(f)})]})]}),n?(0,a.jsx)("div",{children:n}):null]})})}function t_(t){var i=t.notification,n=i||{},e=n.notificationMagnetData,o=n.notificationIsExpired,s=e||{},c=s.notificationMagnetToFollow,r=s.notificationMagnetUsername,l=(0,th.l)({isFollowing:c,username:r}),d=l.onFollowStateChangeAction,u=l.isFollowing,f=l.pending;return(0,a.jsx)(tA,{notification:i,leftSlot:(0,a.jsx)(V,{className:"w-22 cursor-pointer",onClick:function(t){t.preventDefault(),t.stopPropagation(),d()},text:u?"دنبال شده":"دنبال کن",color:u?"low-emphasis":"high-emphasis",pending:f,isDisabled:o})})}var ty={mobile:44,desktop:56};function tS(t){var i=t.notification,n=(0,g.C)().isDesktop,e=(i||{}).notificationMainImage;return(0,a.jsx)(tA,{notification:i,leftSlot:!(0,k.x)(e)&&(0,a.jsx)(K.E,{imageClassName:"rounded",image:e,height:n?ty.desktop:ty.mobile,width:n?ty.desktop:ty.mobile})})}function tO(t){var i=t.notification;return(0,k.x)(i)?null:i.notificationMagnetData.notificationMagnetType===tv.MAGNET_FOLLOW?(0,a.jsx)(t_,{notification:i}):(0,a.jsx)(tS,{notification:i})}function tk(t){var i=t.notification;if((0,k.x)(i))return null;switch(i.notificationType){case td.INFORM_ACTION:return(0,a.jsx)(tg,{notification:i});case td.INFORM_ACTION_IMAGES:return(0,a.jsx)(tx,{notification:i});case td.INFORM_ACTION_COPY:return(0,a.jsx)(tl,{notification:i});case td.MAGNET:return(0,a.jsx)(tO,{notification:i});default:return(0,a.jsx)(tT,{notification:i})}}function tR(t){var i=t.className,n=t.notifications;return(0,a.jsx)("div",{"data-testid":"profile-notifications-list",className:(0,H.d)("bg-neutral-000",i),children:null==n?void 0:n.map(function(t){return(0,a.jsx)(tk,{notification:t},t.notificationId)})})}var tw=n(98780),tP=n(28219),tM=n.n(tP);function tL(t){var i=t.className,n=t.pinNotification;return n?(0,a.jsxs)("div",{"data-testid":"profile-notifications-pin",className:(0,H.d)(i,tM().bg,"py-2 lg:py-5 px-4 flex gap-4 items-center"),children:[(0,a.jsx)(tw.J,{icon:"infoOutline",color:"high-emphasis"}),(0,a.jsx)("p",{className:"text-body-2",children:n})]}):null}var tD=n(57931);function tY(t){var i=t.className,n=t.shouldShowReadAll,e=t.onReadAll;return n?(0,a.jsx)("div",{"data-testid":"profile-notifications-read-all",className:(0,H.d)("bg-neutral-000 mb-4 lg:mb-0 user-select-none",i),children:(0,a.jsx)(tD.z,{removePadding:!0,shape:"text",color:"black",size:"small",onClick:e,appendIcon:"cube-content-check-double",label:"خواندن همه"})}):null}var tU=n(98634),tG={ALL:{TYPE:"all",ICON:"cube-badge-dk-smile"},ALERT:{TYPE:"alert",ICON:"notificationActiveOutline"},ORDER:{TYPE:"order",ICON:"order"},MARKETING:{TYPE:"marketing",ICON:"promo"},TRANSACTION:{TYPE:"transaction",ICON:"invoice"},MAGNET:{TYPE:"magnet",ICON:"cube-badge-magnet-outline"}},tF=function(t){var i=t.data||{},n=i.title,e=i.color;return{tabNotificationNotSeenCount:i.not_seen_count,tabColor:e,tabTitle:n}},tB=(0,F.q)({url:"profile/notifications/tabs/",transformer:function(t){var i=(t.data||{}).tabs||{},n=i.all,e=i.alert,o=i.order,a=i.marketing,s=i.transaction,c=i.magnet;return{allTab:tF({data:n}),alertTab:tF({data:e}),orderTab:tF({data:o}),marketingTab:tF({data:a}),transactionTab:tF({data:s}),magnetTab:tF({data:c})}}}),tq=n(42090),tZ=n.n(tq),tz=(0,e.memo)(function(t){var i=t.type,n=t.icon,e=t.isActive,o=t.onTabChange,s=t.notificationTab,c=t.isAllRead,r=t.isTabCollapsed,l=(0,g.C)().isDesktop,d=s||{},u=d.tabTitle,f=d.tabNotificationNotSeenCount;if(!u)return null;var m=!c&&f>0&&i!==tG.ALL.TYPE;return(0,a.jsxs)("div",{onClick:function(){o(i)},className:(0,H.d)("ml-2 p-2 text-body2-strong text-neutral-700 cursor-pointer w-18 lg:w-unset","flex flex-col lg:flex-row items-center justify-center border-complete rounded relative",{"bg-dark-neutral-000 text-white":e},!l&&{"h-9":r,"h-16":!r},tZ().transition),children:[(0,a.jsx)(tw.J,{icon:n,size:20,color:e?"white":"neutral-700",className:(0,H.d)(r?"opacity-0":"opacity-100",tZ().transition)}),(0,a.jsx)("p",{className:(0,H.d)("lg:mr-1 mt-1 lg:mt-0 whitespace-nowrap",r&&tZ().moveUp),children:u}),m?(0,a.jsx)(tw.J,{className:"lg:static absolute top-0 left-0",icon:"cube-content-dot",size:16,color:e?"white":"primary"}):null]})});function tK(t){var i=t.activeTab,n=void 0===i?"all":i,s=t.onTabChange,c=t.isAllRead,r=t.className,l=(0,e.useRef)(),d=(0,g.C)().isDesktop,u=(0,o.Z)((0,e.useState)(!1),2),f=u[0],m=u[1],p=(0,x.V)({apiMethod:tB}).data,N=p.allTab,T=p.alertTab,v=p.orderTab,h=p.marketingTab,b=p.transactionTab,C=p.magnetTab;return(0,e.useEffect)(function(){var t=(0,tU.P2)(function(){l.current&&!d&&(l.current.getBoundingClientRect().top<=2?m(!0):m(!1))},100);return window.addEventListener("scroll",t),function(){return window.removeEventListener("scroll",t)}},[]),(0,a.jsx)("div",{ref:l,className:(0,H.d)("bg-neutral-000 px-2 lg:px-4 sticky top-0 lg:static z-2 pb-2",r),children:(0,a.jsxs)("div",{className:"flex items-center user-select-none overflow-x-auto hide-scrollbar pt-2 lg:pt-0",children:[(0,a.jsx)(tz,{type:tG.ALL.TYPE,icon:tG.ALL.ICON,notificationTab:N,isActive:tG.ALL.TYPE===n,onTabChange:s,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tz,{type:tG.ALERT.TYPE,icon:tG.ALERT.ICON,notificationTab:T,isActive:tG.ALERT.TYPE===n,onTabChange:s,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tz,{type:tG.ORDER.TYPE,icon:tG.ORDER.ICON,notificationTab:v,isActive:tG.ORDER.TYPE===n,onTabChange:s,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tz,{type:tG.MARKETING.TYPE,icon:tG.MARKETING.ICON,notificationTab:h,isActive:tG.MARKETING.TYPE===n,onTabChange:s,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tz,{type:tG.TRANSACTION.TYPE,icon:tG.TRANSACTION.ICON,notificationTab:b,isActive:tG.TRANSACTION.TYPE===n,onTabChange:s,isAllRead:c,isTabCollapsed:f}),(0,a.jsx)(tz,{type:tG.MAGNET.TYPE,icon:tG.MAGNET.ICON,notificationTab:C,isActive:tG.MAGNET.TYPE===n,onTabChange:s,isAllRead:c,isTabCollapsed:f})]})})}function tH(){var t,i,n=(0,g.C)().isDesktop,u=(0,N.I)(),f=(0,o.Z)((0,e.useState)(tG.ALL.TYPE),2),m=f[0],v=f[1],h=(0,o.Z)((0,e.useState)(!1),2),b=h[0],C=h[1],j=(0,o.Z)((0,e.useState)(1),2),A=j[0],S=j[1],O=(0,T.v)(_.p.notificationCount),L=(t=(0,R.NQ)().ready,i=(0,w.z)().emit,{triggerCustomSurvey:function(t){return i(P.y5,t)},isInAppSurveyServiceReady:t}),D=L.triggerCustomSurvey,Y=L.isInAppSurveyServiceReady,U=(0,x.V)({apiMethod:B,apiData:{type:m,page:A}}),G=U.data,F=U.pending,q=U.reload,Z=(0,p.E)({apiMethod:z,onSuccess:function(){E({unreadNotificationCount:O}),q(),u((0,y.d2)(0)),C(!0)}}).request,K=(0,e.useCallback)(function(t){v(t),I({tabTitle:t}),Y&&D("in-app-survey-notification-change-tab")},[Y]),H=G||{},X=H.notifications,J=H.pinNotification,V=H.pager,Q=function(t){s.NY.scrollToTop({duration:100,smooth:!0}),S(t)};(0,e.useEffect)(function(){S(1)},[m]);var $=(0,e.useMemo)(function(){return F?(0,a.jsx)(r.g,{"data-testid":"profile-notifications-loading",className:"my-50"}):(0,k.x)(X)?(0,a.jsx)(W,{}):(0,a.jsxs)("div",{children:[tG.ALL.TYPE&&(0,a.jsx)(tL,{pinNotification:J}),(0,a.jsx)(tR,{notifications:X}),(0,a.jsx)(l.t,{pageSize:20,pagerCurrentPage:null==V?void 0:V.pagerCurrentPage,pagerTotalPages:null==V?void 0:V.pagerTotalPages,clickAction:Q})]})},[F,X,m,null==V?void 0:V.pagerCurrentPage]),tt=(0,c.useRouter)();return(0,a.jsx)("div",{children:(0,a.jsxs)(d.P,{withTitleLine:n,hasTitleInMobile:!0,shouldShowBack:!0,hasHeaderActionInMobile:!0,onBackClicked:function(){tt.back()},title:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("p",{children:"پیام‌ها"}),O?(0,a.jsx)("div",{className:"bg-primary-500 text-caption-compact text-white px-2 rounded-[100px] pt-1 pb-0.5",children:(0,M.U)(O)}):null]}),headerAction:(0,a.jsx)(tY,{className:"lg:mt-0 mt-4",onReadAll:Z,shouldShowReadAll:O>0}),children:[(0,a.jsx)(tK,{isAllRead:b,activeTab:m,onTabChange:K}),$]})})}var tW=n(70865),tX=n(96670),tJ=(0,F.q)({url:"profile/notifications/",transformer:function(t){var i=t.data||{},n=i.notifications,e=i.pager;return{notifications:(null==n?void 0:n.map(function(t){var i,n,e,o,a,s,c,r,l,d,u,f,m,p,x;return o=(e=t||{}).id,a=e.title,s=e.message,c=e.images,r=e.date,l=e.action_title,d=e.icon_color,u=e.url,f=e.icon,m=e.main_image,p=e.status,x=(0,L.W)({data:f,prefix:"notificationIcon"}),(0,tX.Z)((0,tW.Z)({notificationId:o,notificationTitle:null!=a?a:"",notificationMessage:null!=s?s:"",notificationImages:null!==(i=null==c?void 0:c.map(function(t){return(0,L.W)({data:t})}))&&void 0!==i?i:[],notificationStatus:Y[p],notificationDate:null!=r?r:"",notificationActionTitle:null!=l?l:"",notificationIconColor:null!=d?d:"",notificationUrl:null!==(n=(0,U.f)({data:u}))&&void 0!==n?n:"",notificationIcon:(0,L.W)({data:f})},x),{notificationMainImage:(0,L.W)({data:m})})}))||[],pager:(0,G.d)({data:e})}}}),tV=(0,F.q)({url:"/notification/seen/",type:q.XN.POST,inputTransformer:Z.d});function tQ(t){var i=t.className,n=t.shouldShowReadAll,e=t.onReadAll;return(0,a.jsx)("div",{className:(0,H.d)("bg-neutral-000 mb-4 lg:mb-0 user-select-none",i),children:n&&(0,a.jsx)(tD.z,{shape:"text",color:"secondary",size:"large",onClick:e,prependIcon:"notificationMarkAsRead",iconColor:"secondary",label:"تغییر پیام‌ها به خوانده شده"})})}function t$(t){var i=t.className;return(0,a.jsxs)("div",{className:(0,H.d)("bg-neutral-000 flex flex-col items-center justify-center mx-2 py-10 lg:pt-20 lg:pb-30 user-select-none",i),children:[(0,a.jsx)(K.E,{width:180,height:135,alt:"Empty Notification",src:"/statics/img/svg/profile/empty-notification.svg"}),(0,a.jsx)("div",{className:"mt-3 text-body-1 text-neutral-900",children:"هنوز پیامی نیومده"})]})}function t0(t){var i=t.className,n=t.images,e=t.imageSize,o=t.imageRadius,s=t.imagesAlt,c=t.imageClassName,r=t.maxToDisplay,l=void 0===r?3:r,d=t.withBorder,u=(0,H.d)("flex flex-row gap-4 sm:text text-neutral-500",{"divide-x divide-x-reverse divide-n-100":void 0!==d&&d},i);return(0,a.jsx)("div",{className:u,children:n.map(function(t,i){return i<l?(0,a.jsx)(K.E,{width:e,height:e,image:t,alt:s,rounded:o,objectFit:"cover",className:c},i):i===l?(0,a.jsx)("div",{className:"flex justify-center items-center pr-6 text-body-1 text-neutral-900",children:"".concat((0,M.U)(n.length-l),"+")},i):null})})}var t2=(0,F.q)({type:q.XN.POST,url:function(t){var i=t.notificationId;return"notification/".concat(i,"/seen/")}}),t1=n(55917),t4=n.n(t1);function t6(t){var i=t.notification,n=t.className,e=(0,g.C)().isDesktop,o=(0,p.E)({apiMethod:t2}).request,s=i.notificationId,c=i.notificationTitle,r=i.notificationMessage,l=i.notificationImages,d=i.notificationUrl,u=i.notificationStatus,f=i.notificationDate,m=i.notificationActionTitle,x=i.notificationIconColor,N=i.notificationIcon,T=i.notificationMainImage,v=function(){if(u!==D.NOT_SEEN){j({notificationId:s});return}o({notificationId:s}).then(function(){C({notificationId:s})})};return(0,a.jsxs)(J.r,{className:(0,H.d)("bg-neutral-000 flex items-start py-4 px-2 lg:px-4 br-list-vertical-no-padding-200",n),to:!e&&d,shouldHandleUrlAndOnClick:!0,onClick:!e&&v,children:[N&&x&&(0,a.jsx)("div",{style:{backgroundColor:x},className:(0,H.d)("flex items-center justify-center ml-4 lg:mr-0 rounded-circle shrink-0",t4().ProfileNotificationsListCard__iconContainer),children:(0,a.jsx)(K.E,{width:16,height:16,image:N,alt:"Notification Icon"})}),(0,a.jsxs)("div",{className:"grow flex flex-col relative",children:[u===D.NOT_SEEN&&(0,a.jsx)("div",{className:(0,H.d)("absolute rounded-circle bg-secondary-500 z-1",t4().ProfileNotificationsListCard__notSeenDot)}),(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-body1-strong text-neutral-700",children:(0,M.U)(c)}),(0,a.jsx)("p",{className:"text-body-2 text-neutral-500 w-full",children:(0,M.U)(r)})]}),!(0,k.x)(T)&&(0,a.jsx)(K.E,{width:60,height:60,image:T,alt:"DK-product-notification",className:"mr-2 min-w-15 min-h-15"})]}),!(0,k.x)(l)&&(0,a.jsx)("div",{className:"mt-3 select-none -mr-8 lg:mr-0",children:(0,a.jsx)(t0,{images:l,withBorder:!e,maxToDisplay:e?7:5,imageSize:e?40:32})}),(0,a.jsxs)("div",{className:"flex items-center flex-row-reverse lg:flex-row justify-between mt-3 user-select-none",children:[d&&(0,a.jsx)("div",{onClick:v,children:(0,a.jsxs)(J.r,{to:d,className:"flex items-center text-button-1 text-secondary-500 cursor-pointer",children:[(0,a.jsx)("div",{className:"sm:text",children:m}),(0,a.jsx)(tw.J,{icon:"chevronLeft",size:18,color:"secondary",className:"mr-1"})]})}),(0,a.jsx)("div",{className:"text-neutral-500 xs:text lg:text-xxs",children:(0,M.U)(f)})]})]})]})}function t3(t){var i=t.className,n=t.notifications;return(0,a.jsx)("div",{className:(0,H.d)("bg-neutral-000 mb-6 px-2 lg:px-4",i),children:null==n?void 0:n.map(function(t){return(0,a.jsx)(t6,{notification:t},t.notificationId)})})}var t5=n(74782);function t7(){return(0,a.jsxs)(t5.ZP,{speed:2,viewBox:"0 0 320 66",backgroundColor:"#f3f3f3",foregroundColor:"#ecebeb",className:"m-auto w-full h-full",children:[(0,a.jsx)("circle",{cx:"300",cy:"20",r:"8"}),(0,a.jsx)("rect",{x:"146",y:"14",rx:"4",ry:"4",width:"140",height:"10"}),(0,a.jsx)("rect",{x:"16",y:"30",rx:"4",ry:"4",width:"270",height:"20"}),(0,a.jsx)("rect",{x:"16",y:"55",rx:"4",ry:"4",width:"270",height:"10"})]})}function t8(t){var i=t.className;return(0,a.jsxs)("div",{className:(0,H.d)("bg-neutral-000 flex flex-col items-center justify-center mx-2 lg:mx-0 mb-10 user-select-none",i),children:[(0,a.jsx)(t7,{}),(0,a.jsx)(t7,{}),(0,a.jsx)(t7,{})]})}var t9={ALL:{TYPE:"all",ICON:""},ALERT:{TYPE:"alert",ICON:"notificationActiveOutline"},ORDER:{TYPE:"order",ICON:"order"},MARKETING:{TYPE:"marketing",ICON:"promo"},TRANSACTION:{TYPE:"transaction",ICON:"invoice"}},it=function(t){var i=t.data||{},n=i.title;return{tabNotificationCount:i.count,tabColor:i.color,tabTitle:n}},ii=(0,F.q)({url:"profile/notifications/tabs/",transformer:function(t){var i=(t.data||{}).tabs||{},n=i.all,e=i.alert,o=i.order,a=i.marketing,s=i.transaction;return{notificationTabsAllCount:null==n?void 0:n.count,notificationTabsAllTitle:null==n?void 0:n.title,notificationTabsAllColor:null==n?void 0:n.color,notificationTabsAlertCount:null==e?void 0:e.count,notificationTabsAlertTitle:null==e?void 0:e.title,notificationTabsAlertColor:null==e?void 0:e.color,notificationTabsOrderCount:null==o?void 0:o.count,notificationTabsOrderTitle:null==o?void 0:o.title,notificationTabsOrderColor:null==o?void 0:o.color,notificationTabsMarketingCount:null==a?void 0:a.count,notificationTabsMarketingTitle:null==a?void 0:a.title,notificationTabsMarketingColor:null==a?void 0:a.color,notificationTabsTransactionCount:null==s?void 0:s.count,notificationTabsTransactionTitle:null==s?void 0:s.title,notificationTabsTransactionColor:null==s?void 0:s.color,allTab:it({data:n}),alertTab:it({data:e}),orderTab:it({data:o}),marketingTab:it({data:a}),transactionTab:it({data:s})}}});function ie(t){var i=t.type,n=t.icon,e=t.isActive,o=t.onTabChange,s=t.notificationTab||{},c=s.tabColor,r=s.tabTitle;return r?(0,a.jsxs)(J.r,{onClick:function(){o(i)},className:(0,H.d)("flex items-center text-caption rounded-large py-1 px-3 ml-2 whitespace-nowrap cursor-pointer border-complete-200 text-neutral-700"),style:e?{borderColor:c,color:c}:null,CROId:"profile-messeges-menu",children:[!!n&&(0,a.jsx)(tw.J,{icon:n,size:16,color:e&&c,className:"ml-1"}),r]}):null}function io(t){var i=t.activeTab,n=void 0===i?"all":i,e=t.onTabChange,o=t.className,s=(0,x.V)({apiMethod:ii}).data,c=s.allTab,r=s.alertTab,l=s.orderTab,d=s.marketingTab,u=s.transactionTab;return(0,a.jsx)("div",{className:(0,H.d)("bg-neutral-000 px-2 lg:px-4",o),children:(0,a.jsxs)("div",{className:"flex items-center user-select-none overflow-x-auto hide-scrollbar py-4 lg:py-0",children:[(0,a.jsx)(ie,{type:t9.ALL.TYPE,icon:t9.ALL.ICON,notificationTab:c,isActive:t9.ALL.TYPE===n,onTabChange:e}),(0,a.jsx)(ie,{type:t9.ALERT.TYPE,icon:t9.ALERT.ICON,notificationTab:r,isActive:t9.ALERT.TYPE===n,onTabChange:e}),(0,a.jsx)(ie,{type:t9.ORDER.TYPE,icon:t9.ORDER.ICON,notificationTab:l,isActive:t9.ORDER.TYPE===n,onTabChange:e}),(0,a.jsx)(ie,{type:t9.MARKETING.TYPE,icon:t9.MARKETING.ICON,notificationTab:d,isActive:t9.MARKETING.TYPE===n,onTabChange:e}),(0,a.jsx)(ie,{type:t9.TRANSACTION.TYPE,icon:t9.TRANSACTION.ICON,notificationTab:u,isActive:t9.TRANSACTION.TYPE===n,onTabChange:e})]})})}function ia(){var t=(0,N.I)(),i=(0,g.C)().isDesktop,n=(0,o.Z)((0,e.useState)(t9.ALL.TYPE),2),r=n[0],u=n[1],f=(0,o.Z)((0,e.useState)(1),2),m=f[0],v=f[1],h=(0,T.v)(_.p.notificationCount),b=(0,x.V)({apiMethod:tJ,apiData:{type:r,page:m}}),C=b.data,j=b.pending,A=b.reload,S=(0,p.E)({apiMethod:tV,onSuccess:function(){E({unreadNotificationCount:h}),A(),t((0,y.d2)(0))}}).request,O=C||{},R=O.notifications,w=O.pager,P=function(t){s.NY.scrollToTop({duration:100,smooth:!0}),v(t)};(0,e.useEffect)(function(){v(1)},[r]);var M=(0,e.useMemo)(function(){return j?(0,a.jsx)(t8,{}):(0,k.x)(R)?(0,a.jsx)(t$,{}):(0,a.jsxs)("div",{children:[(0,a.jsx)(t3,{notifications:R}),(0,a.jsx)(l.t,{pageSize:20,pagerCurrentPage:null==w?void 0:w.pagerCurrentPage,pagerTotalPages:null==w?void 0:w.pagerTotalPages,clickAction:P})]})},[j,R,r,null==w?void 0:w.pagerCurrentPage]),L=(0,c.useRouter)();return(0,a.jsxs)("div",{children:[(0,a.jsx)(d.P,{onBackClicked:function(){L.back()},title:"پیغام‌ها",withTitleLine:!1,isMobileHeaderCard:!0}),(0,a.jsxs)(d.P,{isDesktopHeader:!0,title:"پیغام‌ها",withTitleLine:!0,hasWhiteBackground:!1,headerAction:(0,a.jsx)(tQ,{shouldShowReadAll:h>0,onReadAll:S}),children:[!i&&(0,a.jsx)(tQ,{shouldShowReadAll:h>0,onReadAll:S}),(0,a.jsx)(io,{activeTab:r,onTabChange:function(t){u(t),I({tabTitle:t})}}),M]})]})}var is=(0,O.D)({component:function(){return(0,T.v)(A.b.isPendingInit)?(0,a.jsx)(r.g,{className:"my-25"}):(0,S.d)(f.X.NOTIFICATION_CENTER_REDESIGN)?(0,a.jsx)(tH,{}):(0,a.jsx)(ia,{})},layoutProps:{type:u.B.PROFILE,sidebarMenuActiveKey:m.g.NOTIFICATIONS,chatKey:"profile"},isPrivate:!0})},16648:function(t,i,n){"use strict";n.d(i,{R:function(){return s}});var e=n(70865),o=n(52322),a=n(89040);function s(t){return(0,o.jsx)(a.R,(0,e.Z)({},t))}},27876:function(t,i,n){"use strict";n.d(i,{t:function(){return c}});var e=n(70865),o=n(52322),a=n(63222),s=n(27314);function c(t){var i=(0,s.e)().redirect;return(0,o.jsx)(a.t,(0,e.Z)({redirect:i},t))}},41218:function(t,i,n){"use strict";n.d(i,{P:function(){return m}});var e=n(47842),o=n(52322),a=n(16648),s=n(47072),c=n(26442),r=n(64177),l=n(27314),d=n(72677),u=n(33256),f=n.n(u);function m(t){var i=t.children,n=t.className,u=t.title,m=t.headerAction,p=void 0===m?null:m,x=t.withTitleLine,g=t.hideLineInSmallScreen,N=t.hasWhiteBackground,T=t.isMobileHeaderCard,v=t.isDesktopHeader,h=t.hasHeaderActionInMobile,b=t.hasTitleInMobile,C=t.shouldShowBack,j=void 0!==C&&C,E=t.onBackClicked,I=(0,l.e)().redirect,A=(0,r.C)().isDesktop,_=(0,d.d)("mb-4",{"bg-neutral-000":void 0===N||N},n),y=(0,d.d)((0,e.Z)({},f()["ProfileCard__title--mobileHeader"],T));if(T&&A)return null;var S=!!u&&(A&&v||b||T),O=!!p&&(A||h),k=(0,d.d)("flex justify-between items-center lg:py-4 px-4",{"lg:pl-6 lg:pr-4":j});return(0,o.jsxs)(a.R,{className:_,children:[(S||O)&&(0,o.jsxs)("div",{className:k,children:[S&&(0,o.jsx)(s.D,{title:u,withLine:void 0===x||x,className:y,hideLineInSmallScreen:g,rightIcon:!A&&T||j?"arrowRight":null,rightIconOnClick:E||function(){I({url:c._2})}}),O&&p]}),void 0===i?null:i]})}},45873:function(t,i,n){"use strict";n.d(i,{g:function(){return e}});var e={DIGIPLUS:"DIGIPLUS",DASHBOARD:"DASHBOARD",ORDERS:"ORDERS",LISTS:"LISTS",COMMENTS:"COMMENTS",ADDRESSES:"ADDRESSES",GIFT_CARDS:"GIFT_CARDS",NOTIFICATIONS:"NOTIFICATIONS",USER_HISTORY:"USER_HISTORY",USER_INFO:"USER_INFO",LOGOUT:"LOGOUT"}},74136:function(t,i,n){"use strict";n.d(i,{l:function(){return u}});var e=n(66383),o=n(2784),a=n(45227),s=n(1324),c=(0,s.q)({url:function(t){var i=t.username;return"magnet/users/".concat(i,"/follow/")},type:a.XN.POST}),r=(0,s.q)({url:function(t){var i=t.username;return"magnet/users/".concat(i,"/unfollow/")},type:a.XN.POST}),l=n(98634),d=n(11559);function u(t){var i=t.isFollowing,n=t.onSuccess,a=void 0===n?l.ZT:n,s=t.username,u=(0,e.Z)((0,o.useState)(i),2),f=u[0],m=u[1];(0,o.useEffect)(function(){m(i)},[i]);var p=(0,d.E)({apiMethod:c,onSuccess:function(){m(!0),a(!0)}}),x=p.request,g=p.pending,N=(0,d.E)({apiMethod:r,onSuccess:function(){m(!1),a(!1)}}),T=N.request,v=N.pending;return{isFollowing:f,pending:g||v,onFollowStateChangeAction:function(){f?T({username:s}):x({username:s})}}}},90287:function(t,i,n){"use strict";n.d(i,{D:function(){return l}});var e=n(70865),o=n(52322),a=n(64665),s=n(42306),c=n(98324),r=n.n(c);function l(t){var i=t.component,n=t.getAPIMethods,c=t.layoutProps,l=t.isPrivate,d=t.noDefaultLoader,u=t.pageActivatorFeature,f=t.redirectIfLogin,m=t.afterLogin,p=t.disableSSR,x=t.dataProps,g=function(t){return(0,s.d)(a.X.LITE_PAGE_ANIMATION)?(0,o.jsx)("div",{className:r().container,children:(0,o.jsx)(i,(0,e.Z)({},t))}):(0,o.jsx)(i,(0,e.Z)({},t))};return g.getAPIMethods=n,g.layoutProps=c,g.isPrivate=l,g.noDefaultLoader=d,g.pageActivatorFeature=u,g.redirectIfLogin=f,g.afterLogin=m,g.disableSSR=p,g.dataProps=x,g}},18814:function(t){t.exports={NotificationBaseCard__background:"styles_NotificationBaseCard__background__MfBKU"}},19436:function(t){t.exports={NotificationMagnetBaseCard__background:"styles_NotificationMagnetBaseCard__background__ghR1k"}},28219:function(t){t.exports={bg:"styles_bg__hCcOJ"}},42090:function(t){t.exports={transition:"styles_transition__KOxGG",moveUp:"styles_moveUp__2Yvve"}},55917:function(t){t.exports={ProfileNotificationsListCard__iconContainer:"styles_ProfileNotificationsListCard__iconContainer__1rmpg",ProfileNotificationsListCard__notSeenDot:"styles_ProfileNotificationsListCard__notSeenDot__6TmpF"}},33256:function(t){t.exports={"ProfileCard__title--mobileHeader":"styles_ProfileCard__title--mobileHeader__Tpkul"}},98324:function(t){t.exports={container:"styles_container__TOHrJ","fade-out":"styles_fade-out__Z1zNL"}}},function(t){t.O(0,[9774,2888,179],function(){return t(t.s=83514)}),_N_E=t.O()}]);